<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Surat Tugas Marine Inspector</title>
    <link herf="logo-shsk.png" rel="icon" />
    <link
      href="https://fonts.googleapis.com/css2?family=Arial:wght@400;700&family=Times+New+Roman:ital,wght@1&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Monotype+Corsiva&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <nav class="navbar">
      <h1>SURAT TUGAS <span style="color: #d4af37">MARINE INSPECTOR</span></h1>
    </nav>

    <div class="main-container" id="mainContainer">
      <section class="form-section">
        <div class="card">
          <div
            style="
              display: flex;
              justify-content: space-between;
              align-items: center;
              margin-bottom: 20px;
            "
          >
            <h2 style="margin: 0">
              <i class="fas fa-file-pen"></i> Form Surat Tugas
            </h2>

            <div style="text-align: right">
              <label
                for="jumlahSt"
                style="
                  font-size: 0.9rem;
                  margin-bottom: 5px;
                  display: inline-block;
                "
                >Jumlah ST:</label
              >
              <select
                id="jumlahSt"
                class="form-control"
                style="width: 70px; padding: 5px; display: inline-block"
                onchange="renderForms()"
              >
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
              </select>
            </div>
          </div>

          <form id="stForm">
            <div id="dynamicFormContainer"></div>

            <div class="action-buttons">
              <button type="button" id="btnGenerate" class="btn-primary">
                <i class="fas fa-file-pdf"></i> BUAT SURAT TUGAS
              </button>

              <div
                id="editModeButtons"
                class="hidden"
                style="display: flex; gap: 5px; flex-wrap: wrap"
              >
                <button
                  type="button"
                  id="btnUnlock"
                  class="btn-secondary"
                  style="background-color: #ffc107; color: #000"
                >
                  <i class="fas fa-lock-open"></i> Edit Data
                </button>
                <button type="button" id="btnUpdate" class="btn-success hidden">
                  <i class="fas fa-save"></i> Simpan Edit
                </button>
                <button type="button" id="btnCancelEdit" class="btn-danger">
                  <i class="fas fa-times"></i> Batal
                </button>
              </div>
            </div>
          </form>
        </div>
      </section>

      <section class="preview-section hidden" id="previewSection">
        <div class="preview-controls">
          <button id="btnSimpan" class="btn-success">
            <i class="fas fa-save"></i> Simpan Drive
          </button>
          <button id="btnDownload" class="btn-secondary">
            <i class="fas fa-print"></i> Print ST
          </button>
          <button id="btnClosePreview" class="btn-danger">
            <i class="fas fa-times"></i> Tutup Preview
          </button>
        </div>

        <div
          class="preview-pagination-controls"
          id="previewPagControls"
          style="
            display: none;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 10px 0;
          "
        >
          <button
            type="button"
            class="btn-icon"
            onclick="changePreviewPage(-1)"
          >
            <i class="fas fa-chevron-left"></i>
          </button>
          <span
            id="previewPageIndicator"
            style="font-weight: bold; color: var(--navy)"
            >ST 1 / 1</span
          >
          <button type="button" class="btn-icon" onclick="changePreviewPage(1)">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>

        <div id="printArea"></div>
      </section>
    </div>

    <section class="history-section">
      <div class="card full-width">
        <div class="history-header">
          <h3>Riwayat Surat Tugas</h3>

          <div class="header-tools">
            <div class="search-box">
              <i class="fas fa-search"></i>
              <input
                type="text"
                id="searchInput"
                placeholder="Cari Kapal / Pemeriksa..."
              />
            </div>
            <button onclick="fetchHistory()" class="btn-refresh">
              <i class="fas fa-sync"></i> Refresh
            </button>
          </div>
        </div>

        <div class="table-responsive">
          <table id="historyTable">
            <thead>
              <tr>
                <th>No. ST</th>
                <th>Tanggal</th>
                <th>Nama Kapal</th>
                <th>Perusahaan</th>
                <th>Pemeriksa</th>
                <th style="width: 150px">Action</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>

        <div class="pagination-container" id="paginationContainer">
          <span class="page-info" id="pageInfo"
            >Menampilkan 0 - 0 dari 0 data</span
          >
          <div class="pagination-buttons">
            <button id="btnPrev" onclick="changePage(-1)" disabled>
              <i class="fas fa-chevron-left"></i> Prev
            </button>
            <button id="btnNext" onclick="changePage(1)" disabled>
              Next <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        </div>
      </div>
    </section>

    <div id="toast-container"></div>
    <div id="deleteModal" class="modal-overlay hidden">
      <div class="modal-box">
        <div class="modal-icon">
          <i class="fas fa-trash-alt"></i>
        </div>
        <h3>Hapus Data?</h3>
        <p>
          Apakah Anda yakin ingin menghapus Surat Tugas Nomor: <br /><strong
            id="deleteTargetText"
            style="color: var(--navy)"
            >...</strong
          >?
        </p>
        <p class="warning-text">Tindakan ini tidak dapat dibatalkan.</p>

        <div class="modal-buttons">
          <button onclick="closeDeleteModal()" class="btn-cancel">Batal</button>
          <button onclick="executeDelete()" class="btn-confirm-delete">
            Ya, Hapus
          </button>
        </div>
      </div>
    </div>
    <script src="script.js"></script>
  </body>
</html>
